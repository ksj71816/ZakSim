<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="zaksim.dao.ChallengeDao">
  
  	<select id="selectSeq" resultType="int">
  		
  		select challenge_seq.nextval from dual
  	
  	</select>
  
  	<insert id="insertChallenge" parameterType="zaksim.dto.Challenge">
  	
  		INSERT INTO Challenge (idx, member_idx, apply_date, start_date, end_date, money, title, status, result) 
  		VALUES (#{idx}, #{memberIdx},  to_date(sysdate,YYYY-MM-DD), to_date(#{startDate},'YYYY-MM-DD'), to_date('#{endDate}','YYYY-MM-DD'), #{money}, #{title}, #{status}, null);
  	
  	</insert>
  
  
  	<insert id="insertPayment" parameterType="zaksim.dto.Payment">
  		
  		INSERT INTO PAYMENT (imp_uid, merchant_uid, buyer_idx, challenge_idx, price, paid_at, status, payment_option) 
  		VALUES ( #{impUid} , #{merchantUid} , #{buyerIdx} , #{challengeIdx} , #{price} , to_date(#{paidAt}, 'YYYY-MM-DD') , #{status} , #{paymentOption} );
  	
  	</insert>
  
  </mapper>